%------------------------------------------------------------------------------
\documentclass[a4paper,10pt]{article}
%------------------------------------------------------------------------------

\usepackage{amssymb}
\usepackage{amsmath}

% Some math operators
\DeclareMathOperator{\Div}{div}
\DeclareMathOperator{\Grad}{grad}
\newcommand{\inner}[2]{\langle #1, #2 \rangle}
\newcommand{\R}{\mathbb{R}}
\newcommand{\foralls}{\forall\,}
\newcommand{\ddt}[1]{{#1}_t}
\newcommand{\dx}{\dif{}x}
\newcommand{\ds}{\dif{}s}
\newcommand{\dS}{\dif{}S}

\begin{document}

We want to solve a dynamic version of the cardiac mechanics equations, including the
inertia term that is usually neglected. The bounary conditions are as follows:
\begin{itemize}
\item A standard pressure term on the endocardium ($\Gamma_{endo}$)
\item Normal forces on the epicardium ($\Gamma_{endo}$) are a combination of a linear spring
and linear friction
\item Zero tangent force on the epicardium
\item The traction (tangent + normal) on the base ($\Gamma_{top}$) is the sum of
a linear spring and linear friction.
\end{itemize}
In the benchmark description, the equations are written as
\begin{align*}
  \rho \ddot{u} - \nabla\cdot(J\sigma F^{-T}) &= 0, \mbox{ in } \Omega ,\\
  \sigma J F^{-T}N &= pJF^{-TN}, \mbox{ on } \Gamma_{endo}, \\
  \sigma JF^{-T}N\cdot N + \alpha{epi}u\cdot N + \beta_{epi}\dot{u}\cdot N &= 0, \mbox{ on }  \Gamma_{epi}, \\
  \sigma JF^{-T}N\times N &=0, \mbox{ on }  \Gamma_{epi}, \\
  \sigma JF^{-T}N + \alpha_{top}u + \beta_{top}\dot{u} &= 0, \mbox{ on } \Gamma_{top},
\end{align*}
where we have used the notation $\sigma$ for the Cauchy stress to be more in line with standard notation.

In terms of the first Piola-Kirchhoff stress, given by $P = J\sigma F^{-T}$, the problem reads
\begin{align*}
  \rho \ddot{u} - \nabla\cdot P &= 0, \mbox{ in } \Omega ,\\
  \sigma PN &= pJF^{-TN}, \mbox{ on } \Gamma_{endo}, \\
  \sigma PN\cdot N + \alpha{epi}u\cdot N + \beta_{epi}\dot{u}\cdot N &= 0, \mbox{ on }  \Gamma_{epi}, \\
  \sigma PN\times N &=0, \mbox{ on }  \Gamma_{epi}, \\
  \sigma PN + \alpha_{top}u + \beta_{top}\dot{u} &= 0, \mbox{ on } \Gamma_{top}.
\end{align*}

\section{The Newmark $\beta$ scheme}
We consider first a general dynamic equation on the form
\[
M\ddot{u} + C\dot{u} + f^{int}(u) = f_{ext},
\]
where $M$ is the mass matric, $C$ is the damping matrix, and $f^{int}, f^{ext}$
are internal and external forces. Note that the mechanics equation above can also
be written on this general form, since the stress tensor $P$ includes a viscous
component which is a linear function of the velocity $\dot{u}$.
The mechanics equation above can be written on this form, since the second

We introduce the notation $a= \ddot{u}, v=\dot{u}$
for the acceleration and velocity, respectively. The Newmark $\beta$ method can then
be written as
\begin{align}
v_{i+1} &= v_i + (1-\gamma) \Delta t a_i + \gamma \Delta t a_{i+1}, \\
a_{i+1} &= \frac{u_{i+1} - (u_i + \Delta t v_i + (0.5 - \beta) \Delta t^2 a_i)}{\beta \Delta t^2}, \\
Ma_{i+1} &+ C v_{i+1} + f^{int}(u_{i+1}) = f^{ext}_{i+1}.
\end{align}

\appendix
\section{Computing the cavity volume}
One of the quantities reported for the benchmark problem is the cavity volume.
The simplest way to compute this quantity is by an integral over the cavity, i.e.
by
\begin{align}
V &= \int_\Omega dx = \int_{\Omega_0} J dX,
\label{vol0}\end{align}
where $J=\det(F)$ and $F$ is the deformation gradient, or,
equivalently, the Jacobian of the coordinate transformation from $X$
to $x$. This is the approach described in the benchmark description.
The $F$ and $J$ fields inside the cavity are computed from a displacement field
constructed by harmonic lifting.

Our approach for computing the volume does not require a mesh of the cavity,
but instead applies the divergence theorem to turn the volume integral into
a surface integral over the endocardial surface. The divergence theorem states
that
\[
\int_\Omega \nabla\cdot f dx = \int_{\partial\Omega} f\cdot \mathbf{n} ds
\]
holds for any smooth function $f$ on a volume $\Omega$, with $\mathbf{n}$ being the
outward surface normal of $\partial\Omega$. If we introduce an
arbitrary vector-valued function $\mathbf{g}$ satisfying $\nabla\cdot \mathbf{g} = 1$, we have
\[
V =\int_{\Omega} dx = \int_{\Omega}\nabla\cdot \mathbf{g}dx
= \int_{\partial\Omega}\mathbf{g}\cdot\mathbf{n}ds .
\]
There are many simple choices for the function $\mathbf{g}$, for instance $\mathbf{g}=(x_1,0,0)$ or
$\mathbf{g}=\mathbf{x}/3$.

One limitation of this approach is that the surface integral is performed over the
entire boundary $\partial\Omega$, i.e., a closed surface, while the cavity volumes
of interest are usually open at the base. However, if we know the characteristics
of the geometry it is often possible to choose the function $g$ so that the
contribution from the missing part of the surface is zero, and in this case the
volume calculation is accurate. For the benchmark problem, the open
part of the surface is a plane with surface normal $(1,0,0)$. The plane moves
in the $x_1$ direction, but the surface normal stays constant through the
deformation. We can choose, for instance, $\mathbf{g}=(0,x_2,0)$ to ensure that the
contribution from this part of the surface is always zero. We then have
\begin{align}
V &= \int_{\partial\Omega_{endo}}(0,x_2,0) \cdot\mathbf{n}ds ,
\label{vol1}\end{align}
where $\partial\Omega_{endo}$ is the deformed configuration of the (open)
endocardial surface.


We want to convert the surface integral in \eqref{vol1} to an
integral in the reference configuration. We have
\begin{align}
\mathbf{u}(\mathbf{X},t) &= \mathbf{x}(\mathbf{X},t)-\mathbf{X},
\label{displ}\end{align}
where $\mathbf{X}$ is the position vector in the undeformed (material) configuration.
From Nanson's formula we have that
\begin{align}
\mathbf{n}ds &= J\mathbf{F}^{-T}\mathbf{\eta}dS,
\label{nanson}\end{align}
where $\mathbf{\eta}, dS$ are the surface normal and area of the undeformed surface.
Using \eqref{displ}-\eqref{nanson}, we can convert \eqref{vol1} to
\begin{align}
V &=  \int_{\partial\Omega_{endo,0}}(u_2+X_2)\cdot
J\mathbf{F}^{-T}\mathbf{\eta}dS ,
\label{vol2}\end{align}
where $\partial\Omega_{endo,0}$ is the undeformed configuration
of the endocardial surface.







\end{document}
